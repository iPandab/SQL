--数据库的定义
--例3.1 定义一个SQL数据库
CREATE DATABASE SaleProduct


--例3.2 删除SQL数据库SaleProduct
DROP DATABASE SaleProduct


--基本表的定义、删除与修改
--例3.3 创建客户表Customer
CREATE TABLE Customer(
custID varchar(5) PRIMARY KEY,
custName varchar(20) NOT NULL UNIQUE,
custCity varchar(10),
custPhone varchar(13))


--例3.3 也可为约束命名
/*CREATE TABLE Customer(
custID varchar(5) constraint PK_Customer PRIMARY KEY,
custName varchar(20) NOT NULL constraint UQ_Customer UNIQUE,
custCity varchar(10),
custPHONE varchar(13))*/


--例3.4 创建商品表Product.
CREATE TABLE Product(
pdID varchar(5) constraint PK_Product PRIMARY KEY,
pdName varchar(20) NOT NULL,
pdSpec varchar(10),
pdModel varchar(10),
pdSupplier varchar(20) NOT NULL,
pdPrice numeric(10,2) DEFAULT 0 CHECK (pdPrice>=0),pdStockSize int DEFAULT 0 CHECK (pdStockSize>=0) )


--例3.5 创建订单表Orders
CREATE TABLE Orders(
orderID varchar(16) PRIMARY KEY,
orderDate date NOT NULL,
custID varchar(5) NOT NULL
FOREIGN KEY REFERENCES Customer(custID)
ON DELETE cascade
ON UPDATE cascade,
orderAddress varchar(40) NOT NULL,
orderAmount numeric(10,2) NOT NULL)



--例3.5 外码约束还可以定义成表级约束
CREATE TABLE Orders(
orderID varchar(16) PRIMARY KEY,
orderDate date NOT NULL,
custID varchar(5) NOT NULL,
orderAddress varchar(40) NOT NULL,
orderAmount numeric(10, 2) NOT NULL,
FOREIGN KEY (custID) REFERENCES Customer(custID)
ON DELETE cascade
ON UPDATE cascade)


--例3.6 创建订单明细表OrderDetail
CREATE TABLE OrderDetail(
orderID varchar(16) NOT NULL,
pdID varchar(5) NOT NULL,
pdSellPrice numeric(10, 2) NOT NULL,
quantity int NOT NULL,
PRIMARY KEY (orderID,pdID),
FOREIGN KEY (orderID) REFERENCES Orders (orderlD),
FOREIGN KEY (pdID) REFERENCES Product (pdID)
ON UPDATE cascade)


--例3.7 将Product表中的属性列pdName的数据类型改为varchar(30)
ALTER TABLE Product
ALTER COLUMN pdName varchar(30)
--更改某些数据类型可能导致相关数据自动更改


--例3.8 将Product表中的属性列pdName的数据类型改为varchar(2)
ALTER TABLE Product
ALTER COLUMN pdName varchar(2)
--语句操作就会中止，原因在于“将截断字符串或二进制数据”


--例3.9 在Product表中增加一个列:pdMemo(备注)，数据类型为varchar(100)
ALTER TABLE Product
ADD pdMemo varchar(100)


--例3.10 在Customer表中增加默认值约束:custCity(所在城市)，其默认值为“北京”
ALTER TABLE Customer
ADD CONSTRAINT DF_custCity
DEFAULT '北京' for custCity


--例3.11 除Customert表中的完整性约束值RDF_custCity
ALTER TABLE Customer
DROP CONSTRAINT DF_custCity



--例3.12 基本表的删除，删除OrderDetail表
DROP TABLE OrderDetail


--例3.13 在Customer表的属性列custPhone上创建一个唯一索引
CREATE UNIQUE INDEX idx_uq_custPhone
on Customer(custPhone)


--例3.14 删除Customert表的索引idx_uq_custPhone
DROP INDEX idx_uq_custPhone ON Customer


--例3.15 向客户表中插入一个客户记录('907','林巍','北京','17705678942')
INSERT INTO Customer
VALUES ('907','林巍','北京','17705678942')
--说明:列名序列省略，则表示在VALUES后的元组值中提供插入元组的每个分量的值，分量的顺序和关系模式中列名的顺序一致。


--例3.16 向客户表中插入一个客户记录('905','王力','大连','15903541236').
INSERT INTO Customer
VALUES ('905','王力','大连','15903541236')
--运行结果:操作失败
--分析原因:违反了PRIMARY KEY约束


--例3.17 向客户表中插入一个客户记录,客户编号为“904”,客户名称为“张松林”
INSERT INTO Customer(custID,custName)
VALUES ('904','张松林')
--运行结果:操作失败
--分析原因:违反了UNIQUE约束

--例3.18 在订单明细表OrderDetail中插入一个订单明细记录('D201 508201002006','11205', 47,2)
--INSERT INTO OrderDetail
--VALUES('D201508201002006','11205',47,2)
--运行结果:操作失败
--分析原因:违反了FOREIGN KEY约束

--例3.19 删除Customer中客户名称为“张小宁”的客户的基本信息
DELETE FROM Customer
WHERE custName= '张小宁'


--例3.20 删除Product中商品编号为“11206” 的商品信息
DELETE FROM Product
WHERE pdID='11206'
--运行结果:操作失败
--违反参照引用关系

--例3.21 将客户名称为“里奇”的所在城市改为“深圳”
UPDATE Customer
SET custCity ='深圳'
WHERE custName='里奇'

--例3.22 将商品表中所有商品的价格调高10%
UPDATE Product
SET pdPrice=pdPrice*1.1


--例3.23 将客户表中客户编号为“902”的客户编号改为“910”
UPDATE Customer
SET custID='910'
WHERE custID='902'
--运行结果: Customer中客户 编号为“902” 的客户编号成功改为“910”。
--同时订单表Orders中所有引用“902”的元组的custID也同时更新为“910”。


--例3.24 将订单表中订单编号为“D201007010916005”的订单编号改为“D201007010916009”。
UPDATE Orders
SET orderID = 'D201007010916009'
WHERE orderID = 'D201007010916005'
--运行结果:操作失败
--分析原因:违反参照引用关系

--例3.25 将商品表中商品编号为“11205”的商品编号改为“11210”
UPDATE Product
SET pdID='11210'
WHERE pdID='11205'
--运行结果:操作失败
--分析原因:违反了PRIMARY KEY约束











